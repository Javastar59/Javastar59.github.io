(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{206:function(e,s,t){"use strict";t.r(s);var n=t(0),a=Object(n.a)({},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"content"},[t("blockquote",[t("p",[t("code",[e._v("Github webhooks")]),e._v("需要跟我们的服务器进行通信，确保是可以推送到我们的服务器，所以会发送一个带有"),t("code",[e._v("X-Hub-Signature")]),e._v("的"),t("code",[e._v("POST")]),e._v("请求，为了方便我们直接用第三方的库"),t("a",{attrs:{href:"https://github.com/rvagg/github-webhook-handler",target:"_blank",rel:"noopener noreferrer"}},[e._v("github-webhook-handler"),t("OutboundLink")],1),e._v("来接收参数并且做监听事件的处理等工作。")])]),e._v(" "),e._m(0),e._v(" "),e._m(1),t("p",[e._v("然后执行下面命令安装上面提到的第三方库：")]),e._v(" "),e._m(2),e._m(3),e._v(" "),e._m(4),e._m(5),e._v(" "),e._m(6),e._m(7),e._v(" "),e._m(8),e._v(" "),e._m(9),t("p",[e._v("查看启动状态")]),e._v(" "),e._m(10),e._m(11)])},[function(){var e=this.$createElement,s=this._self._c||e;return s("p",[this._v("首先可以在"),s("code",[this._v("shell")]),this._v("脚本的同级目录下面执行下面命令初始化一个"),s("code",[this._v("package.json")]),this._v(":")])},function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("npm init -f\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("npm i -S github-webhook-handler\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var e=this.$createElement,s=this._self._c||e;return s("p",[this._v("接下来创建我们的服务主入口文件"),s("code",[this._v("index.js")]),this._v("：")])},function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("touch index.js\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var e=this.$createElement,s=this._self._c||e;return s("p",[this._v("紧接着参考"),s("code",[this._v("github-webhook-handler")]),this._v("的"),s("code",[this._v("demo")]),this._v("编辑我们的"),s("code",[this._v("index.js")]),this._v("：")])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"language-nod line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("var http = require('http');\nvar createHandler = require('github-webhook-handler');\nvar spawn = require('child_process').spawn;\nvar handler = createHandler({ path: '访问路径', secret: '密钥' });\n\nhttp.createServer(function (req, res) {\n  handler(req, res, function (err) {\n    res.statusCode = 404;\n    res.end('no such location');\n  })\n}).listen(8086);\n\nhandler.on('error', function (err) {\n  console.error('Error:', err.message)\n});\n\n\nhandler.on('push', function (event) {\n  console.log('Received a push event for %s to %s',\n    event.payload.repository.name,\n    event.payload.ref);\n    spawn( 'sh', ['./auto.sh'] );\n});\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br"),t("span",{staticClass:"line-number"},[e._v("19")]),t("br"),t("span",{staticClass:"line-number"},[e._v("20")]),t("br"),t("span",{staticClass:"line-number"},[e._v("21")]),t("br"),t("span",{staticClass:"line-number"},[e._v("22")]),t("br"),t("span",{staticClass:"line-number"},[e._v("23")]),t("br")])])},function(){var e=this.$createElement,s=this._self._c||e;return s("p",[this._v("然后利用node管理工具跑起来服务，这里使用了"),s("code",[this._v("pm2")]),this._v("：")])},function(){var e=this.$createElement,s=this._self._c||e;return s("blockquote",[s("p",[this._v("全局安装pm2命令：npm i -g pm2")])])},function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("pm2 start index.js\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("pm2 list\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var e=this.$createElement,s=this._self._c||e;return s("p",[s("img",{attrs:{src:"https://cdn.star59.top/bg/20190312/oowWVF36o1Ag.png",alt:""}})])}],!1,null,null,null);s.default=a.exports}}]);